<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tableau de bord</title>
<style>
  body{font-family:Segoe UI,Tahoma,Verdana,sans-serif;background:#222244;color:#eee;margin:0;display:none}
  header{background:#1e1e3f;padding:15px 30px;display:flex;justify-content:space-between;align-items:center}
  h1{margin:0;font-weight:600}
  #userEmail{font-style:italic;opacity:.8}
  #logoutBtn{background:#ff5555;border:none;padding:10px 18px;border-radius:6px;color:#fff;cursor:pointer;font-weight:600;transition:background .3s}
  #logoutBtn:hover{background:#cc4444}
  main{padding:30px;max-width:600px;margin:auto}
</style>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
</head>
<body>

<header>
  <h1>Tableau de bord</h1>
  <div>
    <span id="userEmail"></span>
    <button id="logoutBtn">Se déconnecter</button>
  </div>
</header>

<main>
  <p>Bienvenue sur votre tableau de bord personnalisé !</p>
</main>

<script>
  /* ——— même config que dans index.html ——— */
  const firebaseConfig = {
    apiKey: "AIzaSyBBEgLcDNv_9ZNaB0VIZJeNSY_pt3Ia_fw",
    authDomain: "site-pour-me-connecter.firebaseapp.com",
    projectId: "site-pour-me-connecter",
    storageBucket: "site-pour-me-connecter.appspot.com",
    messagingSenderId: "348905349223",
    appId: "1:348905349223:web:bcca114d70d3c41e08f4c2",
    measurementId: "G-1E52LDGDSB"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  const userEmailSpan = document.getElementById('userEmail');
  const logoutBtn     = document.getElementById('logoutBtn');

  /* Persistance déjà locale, on vérifie juste l’état */
  auth.onAuthStateChanged(user=>{
    console.log("Auth state:", user);
    if(user){
      userEmailSpan.textContent = user.email;
      document.body.style.display = 'block';   // révèle la page seulement si connecté
    }else{
      window.location.href = 'index.html';
    }
  });

  logoutBtn.onclick = () => auth.signOut().then(()=>location.href='index.html');
</script>
</body>
</html>
